BootStrap: docker
From: ubuntu:16.04
OSVersion: xenial

%post

    # install some system deps
	echo "deb http://cloud.r-project.org/bin/linux/ubuntu xenial-cran40/" >> /etc/apt/sources.list
	apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9

	apt-get -y update
	apt-get -y install software-properties-common

	add-apt-repository ppa:deadsnakes/ppa

    apt-get -y update
    apt-get -y install locales curl bzip2 less unzip libncurses5-dev zlib1g-dev libgsl0-dev libssl-dev libbz2-dev liblzma-dev wget git autoconf build-essential manpages-dev openjdk-8-jre python python3.6 python3-pip r-base-core pkg-config libcurl4-openssl-dev libxml2-dev r-base r-base-dev
	
    update-alternatives --install /usr/bin/python python /usr/bin/python2.7 1
    update-alternatives --install /usr/bin/python python /usr/bin/python3.6 2
    update-alternatives --set python /usr/bin/python2.7

    wget https://bootstrap.pypa.io/get-pip.py
    python2.7 get-pip.py
    pip install pysam
    pip install numpy

    R -e "install.packages('digest')"
    R -e "install.packages('tidyverse')"


	wget -P /home/BBDD/ http://igenomes.illumina.com.s3-website-us-east-1.amazonaws.com/Homo_sapiens/Ensembl/GRCh37/Homo_sapiens_Ensembl_GRCh37.tar.gz
	tar xvfz /home/BBDD/Homo_sapiens_Ensembl_GRCh37.tar.gz
	wget -P /home/BBDD/ http://igenomes.illumina.com.s3-website-us-east-1.amazonaws.com/Homo_sapiens/NCBI/GRCh38/Homo_sapiens_NCBI_GRCh38.tar.gz
	tar xvfz /home/BBDD/Homo_sapiens_NCBI_GRCh38.tar.gz

    mkdir /data-store

    mkdir /data_store

# ###################### ALIEN #######################################

%apprun minimap
	exec alien "$@"

%appinstall alien
	apt-get install -y alien

# ####################################################################


%labels
	Author Fernández-Peñalver-Sergio
	Version v0.1


